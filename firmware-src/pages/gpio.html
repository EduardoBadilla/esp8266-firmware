<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <title>GPIO</title>
    <script type="text/javascript">
        function print(text, err = false) {
            document.getElementById('output').style.color = err ? 'red' : 'green';
            document.getElementById('output').innerHTML = text;
        }
        function send(command, data, cb) {
            print('');
            localStorage['accesskey'] = document.getElementById('accesskey').value;
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open('POST', "http://" + window.location.hostname + '/api/gpio/' + command, true);
            xmlhttp.setRequestHeader("Authorization", "Bearer " + localStorage['accesskey']);
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4) {
                    if (xmlhttp.status < 200 || xmlhttp.status > 299) {
                        print('ERROR: Command returned ' + xmlhttp.status + ' ' + xmlhttp.responseText, true);
                    } else {
                        cb(xmlhttp.responseText);
                    }
                }
            }
            xmlhttp.send(data);
        }
        function get(pin) {
            send('read', null, function (text) {
                json = JSON.parse(text);
                print('GPIO' + pin + ': ' + json[pin.toString()]);
            });
        }
        function set(pin, val) {
            var json = {}
            json[String(pin)] = val;
            send('write', JSON.stringify(json), function (text) {
                print('Value ' + val + ' was written to GPIO' + pin);
            });
        }
        function init() {
            document.getElementById('accesskey').value = localStorage['accesskey'];
        }
    </script>
</head>
<body onload="init()">
<div class="header">
    <div class="devecihive-logo-text"></div>
    <div class="key-box">
        <label for="accesskey">AccesKey: </label>
        <input class="input-accesskey input-data" type="password" id="accesskey">
    </div>
</div>
<div class="content">
    <div class="form-block">

        <div class="description">This sample can read and write to GPIO ports.</div>
        <div class="group-box">
            <div class="group-box_title">GPIO0</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>
        <div class="group-box">
            <div class="group-box_title">GPIO1</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>
        <div class="group-box">
            <div class="group-box_title">GPIO2</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>
        <div class="group-box">
            <div class="group-box_title">GPIO3</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>
        <div class="group-box">
            <div class="group-box_title">GPIO4</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>
        <div class="group-box">
            <div class="group-box_title">GPIO5</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>
        <div class="group-box">
            <div class="group-box_title">GPIO12</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>
        <div class="group-box">
            <div class="group-box_title">GPIO13</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>
        <div class="group-box">
            <div class="group-box_title">GPIO14</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>
        <div class="group-box">
            <div class="group-box_title">GPIO15</div>
            <button class="btn_event" type="button" value="Read" onclick="get(0);">Read</button>
            <button class="btn_event" type="button" value="Set 1" onclick="set(0, 1);">Set 1</button>
            <button class="btn_event" type="button" value="Set 0" onclick="set(0, 0);">Set 0</button>
        </div>


        <div class="output-status" id="output"></div>
    </div>
</div>

</body>
</html>
